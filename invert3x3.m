function inv = invert3x3(m)

% Direct inversion of 3x3 matrix

inv = zeros(3);

det = m(1,1)*(m(2,2)*m(3,3)-m(2,3)*m(3,2))+m(1,2)*(m(2,3)*m(3,1)-m(2,1)*m(3,3))+m(1,3)*(m(2,1)*m(3,2)-m(2,2)*m(3,1));

inv(1,1) = m(2,2)*m(3,3)-m(2,3)*m(3,2);
inv(1,2) = m(1,3)*m(3,2)-m(1,2)*m(3,3);
inv(1,3) = m(1,2)*m(2,3)-m(1,3)*m(2,2);
inv(2,1) = m(2,3)*m(3,1)-m(2,1)*m(3,3);
inv(2,2) = m(1,1)*m(3,3)-m(1,3)*m(3,1);
inv(2,3) = m(1,3)*m(2,1)-m(1,1)*m(2,3);
inv(3,1) = m(2,1)*m(3,2)-m(2,2)*m(3,1);
inv(3,2) = m(1,2)*m(3,1)-m(1,1)*m(3,2);
inv(3,3) = m(1,1)*m(2,2)-m(1,2)*m(2,1);

inv = inv/det;
